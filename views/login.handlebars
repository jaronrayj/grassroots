<div class="container">
  <h2>New User</h2>
  <form id="user_form" class="form-horizontal">
    <div class="form-group">
      <label class="control-label col-sm-2" for="username">Username:</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="username" placeholder="Enter a Username" name="username" required>
      </div>
    </div>
    <div class="form-group">
      <label class="control-label col-sm-2" for="email">Email:</label>
      <div class="col-sm-10">
        <input type="email" class="form-control" id="email" placeholder="Enter email" name="email" required>
      </div>
    </div>
    <div class="form-group">
      <label class="control-label col-sm-2" for="pwd">Password:</label>
      <div class="col-sm-10">
        <input type="password" class="form-control" id="pwd" placeholder="Enter password" name="pwd" required>
      </div>
    </div>
    <div class="form-group">
      <label class="control-label col-sm-2" for="pw2">Re-Enter Password:</label>
      <div class="col-sm-10">
        <input type="password" class="form-control" id="pwd2" placeholder="Enter password again" name="pwd2" required>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" class="create-user btn btn-info btn-default">Submit</button>
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10"> Already have an account?
        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModalCenter">
          Login
        </button>
      </div>
    </div>
  </form>

  <!-- Modal -->
  <form>
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
      aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalCenterTitle">Login</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label class="control-label col-sm-2" for="userUsername">Username:</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="userUsername" placeholder="Enter Your Username"
                  name="userUsername">
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="userPwd">Password:</label>
              <div class="col-sm-10">
                <input type="password" class="form-control" id="userPwd" placeholder="Enter Your Password"
                  name="userPwd">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-info">Login</button>
          </div>
        </div>
      </div>
    </div>
  </form>


  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous">

    // $(document).on("submit", ".login", loginUser);
    $(document).on("submit", "#user_form", initUser);


    function initUser(e) {
      e.preventDefault();
      console.log('test')
      let $pwd = $("#pwd").val().trim();
      let $pwd2 = $("#pwd2").val().trim();

      if ($pwd !== $pwd2) {
        alert("Those passwords do not match");
      } else {
        createUser();
      }

    }

    function createUser() {

      let newUser = {
        user_name: $("#username").val().trim(),
        password: $("#pwd").val().trim(),
        email: $("#email").val().trim()
      };

      $.post("/api/users", newUser).then(
        function (data) {
          console.log(data);
          if (data) {
            // window.location.replace("/projects");
          } else {
            alert("Sorry, username is taken, please try another")
          }
        });


    }

  </script>